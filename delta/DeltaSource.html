<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title> DeltaSource&#8201;&#8212;&#8201;Streaming Source of Delta Data Source :: The Internals Of Delta Lake</title>
    <link rel="canonical" href="https://books.japila.pl/delta-lake-internals/delta/DeltaSource.html">
    <link rel="prev" href="DeltaOptions.html">
    <link rel="next" href="DeltaSourceOffset.html">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../_/css/site.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-151208281-1"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','UA-151208281-1')</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://books.japila.pl/delta-lake-internals">The Internals Of Delta Lake</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="delta" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Delta Lake</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="installation.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="time-travel.html">Time Travel</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="delta-sql.html">Delta SQL</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="delta-sql-spark3.html">Delta SQL and Spark 3.0.0</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DeltaTableV2.html">DeltaTableV2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="AlterDeltaTableCommand.html">AlterDeltaTableCommand</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="AlterTableAddColumnsDeltaCommand.html">AlterTableAddColumnsDeltaCommand</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="AlterTableChangeColumnDeltaCommand.html">AlterTableChangeColumnDeltaCommand</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="AlterTableReplaceColumnsDeltaCommand.html">AlterTableReplaceColumnsDeltaCommand</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="AlterTableSetLocationDeltaCommand.html">AlterTableSetLocationDeltaCommand</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="AlterTableSetPropertiesDeltaCommand.html">AlterTableSetPropertiesDeltaCommand</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="AlterTableUnsetPropertiesDeltaCommand.html">AlterTableUnsetPropertiesDeltaCommand</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="CreateDeltaTableCommand.html">CreateDeltaTableCommand</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="DeltaSQLConf.html">Configuration Properties</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="DeltaTable.html">DeltaTable</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DeltaTableOperations.html">DeltaTableOperations</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="DeltaLog.html">DeltaLog</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Operation.html">Operation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Checkpoints.html">Checkpoints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="MetadataCleanup.html">MetadataCleanup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="LogStoreProvider.html">LogStoreProvider</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VerifyChecksum.html">VerifyChecksum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="Snapshot.html">Snapshot</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="InMemoryLogReplay.html">InMemoryLogReplay</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="PartitionFiltering.html">PartitionFiltering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DeltaFileFormat.html">DeltaFileFormat</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="commands.html">Commands</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="DeltaConvert.html">DeltaConvert</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ConvertToDeltaCommand.html">ConvertToDeltaCommand</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DeleteCommand.html">DeleteCommand</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DeltaCommand.html">DeltaCommand</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="DeltaGenerateCommand.html">DeltaGenerateCommand</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="DeltaGenerateCommandBase.html">DeltaGenerateCommandBase</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="GenerateSymlinkManifest.html">GenerateSymlinkManifest</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DescribeDeltaDetailCommand.html">DescribeDeltaDetailCommand</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DescribeDeltaHistoryCommand.html">DescribeDeltaHistoryCommand</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="UpdateCommand.html">UpdateCommand</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="vacuum.html">Vacuum</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="VacuumCommand.html">VacuumCommand</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="VacuumCommandImpl.html">VacuumCommandImpl</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="VacuumTableCommand.html">VacuumTableCommand</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="WriteIntoDelta.html">WriteIntoDelta</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="OptimisticTransaction.html">OptimisticTransaction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="TransactionalWrite.html">TransactionalWrite</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DelayedCommitProtocol.html">DelayedCommitProtocol</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="PostCommitHook.html">Post-Commit Hooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="OptimisticTransactionImpl.html">OptimisticTransactionImpl</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="LogStore.html">LogStore</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="HDFSLogStore.html">HDFSLogStore</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="HadoopFileSystemLogStore.html">HadoopFileSystemLogStore</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ImplicitMetadataOperation.html">ImplicitMetadataOperation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="DeltaFileOperations.html">DeltaFileOperations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="SchemaUtils.html">SchemaUtils</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="DeltaTableUtils.html">DeltaTableUtils</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Invariants.html">Invariants</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="DeltaInvariantCheckerExec.html">DeltaInvariantCheckerExec</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="TahoeFileIndex.html">TahoeFileIndex</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="TahoeBatchFileIndex.html">TahoeBatchFileIndex</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="TahoeLogFileIndex.html">TahoeLogFileIndex</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="DeltaHistoryManager.html">DeltaHistoryManager</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="Action.html">Action</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="AddFile.html">AddFile</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="CommitInfo.html">CommitInfo</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="FileAction.html">FileAction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Metadata.html">Metadata</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Protocol.html">Protocol</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="RemoveFile.html">RemoveFile</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="SetTransaction.html">SetTransaction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="SingleAction.html">SingleAction</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="DeltaConfigs.html">DeltaConfigs</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DeltaConfig.html">DeltaConfig</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="FileNames.html">FileNames</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="DeltaLogFileIndex.html">DeltaLogFileIndex</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="DeltaErrors.html">DeltaErrors</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="StateCache.html">StateCache</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="CachedDS.html">CachedDS</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="others.html">The Others (Contenders)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Delta Data Source</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="DeltaDataSource.html">DeltaDataSource</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="DeltaOptions.html">DeltaOptions</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="DeltaSource.html">DeltaSource</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DeltaSourceOffset.html">DeltaSourceOffset</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="SnapshotIterator.html">SnapshotIterator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DeltaSourceSnapshot.html">DeltaSourceSnapshot</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="DeltaSink.html">DeltaSink</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Spark SQL Extensions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="DeltaCatalog.html">DeltaCatalog</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="StagedDeltaTableV2.html">StagedDeltaTableV2</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="DeltaSparkSessionExtension.html">DeltaSparkSessionExtension</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="DeltaSqlParser.html">DeltaSqlParser</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="DeltaSqlAstBuilder.html">DeltaSqlAstBuilder</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DeltaAnalysis.html">DeltaAnalysis</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DeltaUnsupportedOperationsCheck.html">DeltaUnsupportedOperationsCheck</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="PreprocessTableDelete.html">PreprocessTableDelete</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="PreprocessTableMerge.html">PreprocessTableMerge</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="PreprocessTableUpdate.html">PreprocessTableUpdate</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Merge Operation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="DeltaMergeBuilder.html">DeltaMergeBuilder</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DeltaMergeMatchedActionBuilder.html">DeltaMergeMatchedActionBuilder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DeltaMergeNotMatchedActionBuilder.html">DeltaMergeNotMatchedActionBuilder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="DeltaMergeIntoClause.html">DeltaMergeIntoClause</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="DeltaMergeInto.html">DeltaMergeInto</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="MergeIntoCommand.html">MergeIntoCommand</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Demos</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="demo/Converting-Parquet-Dataset-Into-Delta-Format.html">Converting Parquet Dataset Into Delta Format</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="demo/stream-processing-of-delta-table.html">Stream Processing of Delta Table</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="demo/Using-Delta-Lake-as-Streaming-Sink-in-Structured-Streaming.html">Using Delta Lake as Streaming Sink in Structured Streaming</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="demo/Debugging-Delta-Lake-Using-IntelliJ-IDEA.html">Debugging Delta Lake Using IntelliJ IDEA</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="demo/Observing-Transaction-Retries.html">Observing Transaction Retries</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="demo/DeltaTable-DeltaLog-And-Snapshots.html">DeltaTable, DeltaLog And Snapshots</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="demo/schema-evolution.html">Schema Evolution</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="demo/using-user-metadata-to-distinguish-commits-streaming-queries.html">Using User Metadata to Distinguish Commits of Streaming Queries</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Delta Lake</span>
    <span class="version">0.7.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Delta Lake</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">0.7.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Delta Lake</a></li>
    <li>Delta Data Source</li>
    <li><a href="DeltaSource.html">DeltaSource</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/japila-books/delta-lake-internals/edit/master/modules/ROOT/pages/DeltaSource.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page"><a id="DeltaSource"></a> DeltaSource&#8201;&#8212;&#8201;Streaming Source of Delta Data Source</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><code>DeltaSource</code> is the streaming source of <a href="DeltaDataSource.html" class="page">delta data source</a> for streaming queries in Spark Structured Streaming.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Read up on <a href="https://jaceklaskowski.gitbooks.io/spark-structured-streaming/spark-sql-streaming-Source.html">Streaming Source</a> in <a href="https://bit.ly/spark-structured-streaming">The Internals of Spark Structured Streaming</a> online book.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>DeltaSource</code> is <a href="#creating-instance">created</a> when <code>DeltaDataSource</code> is requested for a <a href="DeltaDataSource.html#createSource" class="page">streaming source</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>val q = spark
  .readStream               // Creating a streaming query
  .format("delta")          // Using delta data source
  .load("/tmp/delta/users") // Over data in a delta table
  .writeStream
  .format("memory")
  .option("queryName", "demo")
  .start
import org.apache.spark.sql.execution.streaming.{MicroBatchExecution, StreamingQueryWrapper}
val plan = q.asInstanceOf[StreamingQueryWrapper]
  .streamingQuery
  .asInstanceOf[MicroBatchExecution]
  .logicalPlan
import org.apache.spark.sql.execution.streaming.StreamingExecutionRelation
val relation = plan.collect { case r: StreamingExecutionRelation =&gt; r }.head

import org.apache.spark.sql.delta.sources.DeltaSource
assert(relation.source.asInstanceOf[DeltaSource])

scala&gt; println(relation.source)
DeltaSource[file:/tmp/delta/users]</code></pre>
</div>
</div>
<div id="maxFilesPerTrigger" class="paragraph">
<p><code>DeltaSource</code> uses <a href="DeltaOptions.html#maxFilesPerTrigger" class="page">maxFilesPerTrigger</a> option to limit the number of files to process when requested for the <a href="#getChangesWithRateLimit">file additions (with rate limit)</a>.</p>
</div>
<div id="logging" class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Enable <code>ALL</code> logging level for <code>org.apache.spark.sql.delta.sources.DeltaSource</code> logger to see what happens inside.</p>
</div>
<div class="paragraph">
<p>Add the following line to <code>conf/log4j.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>log4j.logger.org.apache.spark.sql.delta.sources.DeltaSource=ALL</code></pre>
</div>
</div>
<div class="paragraph">
<p>Refer to <a href="logging.html" class="page">Logging</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-deltasource-instance"><a class="anchor" href="#creating-deltasource-instance"></a><a class="link" href="#creating-deltasource-instance"><a id="creating-instance"></a> Creating DeltaSource Instance</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>DeltaSource</code> takes the following to be created:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="spark"></a> <code>SparkSession</code></p>
</li>
<li>
<p><a id="deltaLog"></a> <a href="DeltaLog.html" class="page">DeltaLog</a> of the delta table to read data (as <a href="#getBatch">micro-batches</a>) from</p>
</li>
<li>
<p><a id="options"></a> <a href="DeltaOptions.html" class="page">DeltaOptions</a></p>
</li>
<li>
<p><a id="filters"></a> Filter expressions (default: no filters)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>DeltaSource</code> initializes the <a href="#internal-properties">internal properties</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="micro-batch-with-data-between-start-and-end-offsets-streaming-dataframegetbatch-method"><a class="anchor" href="#micro-batch-with-data-between-start-and-end-offsets-streaming-dataframegetbatch-method"></a><a class="link" href="#micro-batch-with-data-between-start-and-end-offsets-streaming-dataframegetbatch-method"><a id="getBatch"></a> Micro-Batch With Data Between Start And End Offsets (Streaming DataFrame)&#8201;&#8212;&#8201;<code>getBatch</code> Method</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">getBatch(
  start: Option[Offset],
  end: Offset): DataFrame</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>getBatch</code> is part of the <code>Source</code> contract (<a href="https://jaceklaskowski.gitbooks.io/spark-structured-streaming/spark-sql-streaming-Source.html">Spark Structured Streaming</a>) for a streaming <code>DataFrame</code> with data between the start and end offsets.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>getBatch</code> creates an <a href="DeltaSourceOffset.html" class="page">DeltaSourceOffset</a> for the <a href="#tableId">tableId</a> (aka <a href="DeltaSourceOffset.html#reservoirId" class="page">reservoirId</a>) and the given <code>end</code> offset.</p>
</div>
<div class="paragraph">
<p><code>getBatch</code> <a href="#getChanges">gets the changes</a> as follows&#8230;&#8203;FIXME</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="latest-available-offsetgetoffset-method"><a class="anchor" href="#latest-available-offsetgetoffset-method"></a><a class="link" href="#latest-available-offsetgetoffset-method"><a id="getOffset"></a> Latest Available Offset&#8201;&#8212;&#8201;<code>getOffset</code> Method</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">getOffset: Option[Offset]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>getOffset</code> is part of the <code>Source</code> abstraction (<a href="https://jaceklaskowski.gitbooks.io/spark-structured-streaming/spark-sql-streaming-Source.html">Spark Structured Streaming</a>) for the latest available offset of this streaming source.
</td>
</tr>
</table>
</div>
<div id="getOffset-currentOffset" class="paragraph">
<p><code>getOffset</code> calculates the latest offset (that a streaming query can use for the data of the next micro-batch) based on the <a href="#previousOffset">previousOffset</a> internal registry.</p>
</div>
<div class="paragraph">
<p>For no <a href="#previousOffset">ending offset of the latest micro-batch</a>, <code>getOffset</code> simply <a href="#getStartingOffset">retrieves the starting offset</a> (based on the latest version of the delta table).</p>
</div>
<div class="paragraph">
<p>When the <a href="#previousOffset">ending offset of the latest micro-batch</a> is defined (which means that the <code>DeltaSource</code> is requested for another micro-batch), <code>getOffset</code> takes the <a href="#iteratorLast">last indexed AddFile</a> from <a href="#getChangesWithRateLimit">getChangesWithRateLimit</a> for the <a href="#previousOffset">previous ending offset</a>. <code>getOffset</code> returns the <a href="#previousOffset">previous ending offset</a> when the last element was not available.</p>
</div>
<div class="paragraph">
<p>With the <a href="#previousOffset">ending offset of the latest micro-batch</a> and the <a href="#iteratorLast">last indexed AddFile</a> both available, <code>getOffset</code> creates a new <a href="DeltaSourceOffset.html" class="page">DeltaSourceOffset</a> for the version, index, and <code>isLast</code> flag from the last indexed <a href="AddFile.html" class="page">AddFile</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>isStartingVersion</code> local value is enabled (<code>true</code>) when the following holds:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Version of the last indexed <a href="AddFile.html" class="page">AddFile</a> is equal to the <a href="DeltaSourceOffset.html#reservoirVersion" class="page">reservoirVersion</a> of the <a href="#previousOffset">previous ending offset</a></p>
</li>
<li>
<p><a href="DeltaSourceOffset.html#isStartingVersion" class="page">isStartingVersion</a> flag of the <a href="#previousOffset">previous ending offset</a> is enabled (<code>true</code>)</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the end, <code>getOffset</code> prints out the following DEBUG message to the logs (using the <a href="#previousOffset">previousOffset</a> internal registry):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>previousOffset -&gt; currentOffset: [previousOffset] -&gt; [currentOffset]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="stoppingstop-method"><a class="anchor" href="#stoppingstop-method"></a><a class="link" href="#stoppingstop-method"><a id="stop"></a> Stopping&#8201;&#8212;&#8201;<code>stop</code> Method</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">stop(): Unit</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>stop</code> is part of the streaming <code>Source</code> contract (<a href="https://jaceklaskowski.gitbooks.io/spark-structured-streaming/spark-sql-streaming-Source.html">Spark Structured Streaming</a>) to stop this source and free up any resources allocated.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>stop</code> simply <a href="#cleanUpSnapshotResources">cleanUpSnapshotResources</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="retrieving-starting-offsetgetstartingoffset-internal-method"><a class="anchor" href="#retrieving-starting-offsetgetstartingoffset-internal-method"></a><a class="link" href="#retrieving-starting-offsetgetstartingoffset-internal-method"><a id="getStartingOffset"></a> Retrieving Starting Offset&#8201;&#8212;&#8201;<code>getStartingOffset</code> Internal Method</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">getStartingOffset(): Option[Offset]</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>getStartingOffset</code> requests the <a href="#deltaLog">DeltaLog</a> for the version of the delta table (by requesting for the <a href="DeltaLog.html#snapshot" class="page">current state (snapshot)</a> and then for the <a href="Snapshot.html#version" class="page">version</a>).</p>
</div>
<div class="paragraph">
<p><code>getStartingOffset</code> <a href="#iteratorLast">takes the last file</a> from the <a href="#getChangesWithRateLimit">files added (with rate limit)</a> for the version of the delta table, <code>-1L</code> as the <code>fromIndex</code>, and the <code>isStartingVersion</code> flag enabled (<code>true</code>).</p>
</div>
<div class="paragraph">
<p><code>getStartingOffset</code> returns a new <a href="DeltaSourceOffset.html" class="page">DeltaSourceOffset</a> for the <a href="#tableId">tableId</a>, the version and the index of the last file added, and whether the last file added is the last file of its version.</p>
</div>
<div class="paragraph">
<p><code>getStartingOffset</code> returns <code>None</code> (<em>offset not available</em>) when either happens:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the version of the delta table is negative (below <code>0</code>)</p>
</li>
<li>
<p>no files were added in the version</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>getStartingOffset</code> throws an <code>AssertionError</code> when the version of the last file added is smaller than the delta table&#8217;s version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>assertion failed: getChangesWithRateLimit returns an invalid version: [v] (expected: &gt;= [version])</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>getStartingOffset</code> is used exclusively when <code>DeltaSource</code> is requested for the <a href="#getOffset">latest available offset</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getchanges-internal-method"><a class="anchor" href="#getchanges-internal-method"></a><a class="link" href="#getchanges-internal-method"><a id="getChanges"></a> <code>getChanges</code> Internal Method</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">getChanges(
  fromVersion: Long,
  fromIndex: Long,
  isStartingVersion: Boolean): Iterator[IndexedFile]</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>getChanges</code> branches per the given <code>isStartingVersion</code> flag (enabled or not):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>isStartingVersion</code> flag enabled (<code>true</code>), <code>getChanges</code> <a href="#getSnapshotAt">gets the state (snapshot)</a> for the given <code>fromVersion</code> followed by <a href="#getChanges-filterAndIndexDeltaLogs">(filtered out) indexed AddFiles</a> for the next version after the given <code>fromVersion</code></p>
</li>
<li>
<p>For <code>isStartingVersion</code> flag disabled (<code>false</code>), <code>getChanges</code> simply gives <a href="#getChanges-filterAndIndexDeltaLogs">(filtered out) indexed AddFiles</a> for the given <code>fromVersion</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>isStartingVersion</code> flag simply adds <a href="#getSnapshotAt">the state (snapshot)</a> before <a href="#getChanges-filterAndIndexDeltaLogs">(filtered out) indexed AddFiles</a> when enabled (<code>true</code>).</p>
</div>
<div class="paragraph">
<p><code>isStartingVersion</code> flag is enabled when <code>DeltaSource</code> is requested for the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#getBatch">Micro-batch with data between start and end offsets</a> and the start offset is not given or is for the <a href="DeltaSourceOffset.html#isStartingVersion" class="page">starting version</a></p>
</li>
<li>
<p><a href="#getOffset">Latest available offset</a> with no <a href="#previousOffset">end offset of the latest micro-batch</a> or the <a href="#previousOffset">end offset of the latest micro-batch</a> for the <a href="DeltaSourceOffset.html#isStartingVersion" class="page">starting version</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the end, <code>getChanges</code> filters out (<em>excludes</em>) indexed <a href="AddFile.html" class="page">AddFiles</a> that are not with the version later than the given <code>fromVersion</code> or the index greater than the given <code>fromIndex</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>getChanges</code> is used when <code>DeltaSource</code> is requested for the <a href="#getOffset">latest available offset</a> (when requested for the <a href="#getChangesWithRateLimit">files added (with rate limit)</a>) and <a href="#getBatch">getBatch</a>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="filterandindexdeltalogs-internal-method"><a class="anchor" href="#filterandindexdeltalogs-internal-method"></a><a class="link" href="#filterandindexdeltalogs-internal-method"><a id="getChanges-filterAndIndexDeltaLogs"></a> <code>filterAndIndexDeltaLogs</code> Internal Method</a></h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">filterAndIndexDeltaLogs(
  startVersion: Long): Iterator[IndexedFile]</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>filterAndIndexDeltaLogs</code>&#8230;&#8203;FIXME</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="retrieving-file-additions-with-rate-limitgetchangeswithratelimit-internal-method"><a class="anchor" href="#retrieving-file-additions-with-rate-limitgetchangeswithratelimit-internal-method"></a><a class="link" href="#retrieving-file-additions-with-rate-limitgetchangeswithratelimit-internal-method"><a id="getChangesWithRateLimit"></a> Retrieving File Additions (With Rate Limit)&#8201;&#8212;&#8201;<code>getChangesWithRateLimit</code> Internal Method</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">getChangesWithRateLimit(
  fromVersion: Long,
  fromIndex: Long,
  isStartingVersion: Boolean): Iterator[IndexedFile]</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>getChangesWithRateLimit</code> <a href="#getChanges">get the changes</a> (as indexed <a href="AddFile.html" class="page">AddFiles</a>) for the given <code>fromVersion</code>, <code>fromIndex</code>, and <code>isStartingVersion</code> flag.</p>
</div>
<div class="paragraph">
<p><code>getChangesWithRateLimit</code> takes the configured number of <code>AddFiles</code> (up to the <a href="#maxFilesPerTrigger">maxFilesPerTrigger</a> option (if defined) or <a href="DeltaOptions.html#MAX_FILES_PER_TRIGGER_OPTION_DEFAULT" class="page">1000</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>getChangesWithRateLimit</code> is used when <code>DeltaSource</code> is requested for the <a href="#getOffset">latest available offset</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="retrieving-state-of-delta-table-at-given-versiongetsnapshotat-internal-method"><a class="anchor" href="#retrieving-state-of-delta-table-at-given-versiongetsnapshotat-internal-method"></a><a class="link" href="#retrieving-state-of-delta-table-at-given-versiongetsnapshotat-internal-method"><a id="getSnapshotAt"></a> Retrieving State Of Delta Table At Given Version&#8201;&#8212;&#8201;<code>getSnapshotAt</code> Internal Method</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">getSnapshotAt(
  version: Long): Iterator[IndexedFile]</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>getSnapshotAt</code> requests the <a href="#initialState">DeltaSourceSnapshot</a> for the <a href="SnapshotIterator.html#iterator" class="page">data files</a> (as indexed <a href="AddFile.html" class="page">AddFiles</a>).</p>
</div>
<div class="paragraph">
<p>In case the <a href="#initialState">DeltaSourceSnapshot</a> hasn&#8217;t been initialized yet (<code>null</code>) or the requested version is different from the <a href="#initialStateVersion">initialStateVersion</a>, <code>getSnapshotAt</code> does the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#cleanUpSnapshotResources">cleanUpSnapshotResources</a></p>
</li>
<li>
<p>Requests the <a href="#deltaLog">DeltaLog</a> for the <a href="DeltaLog.html#getSnapshotAt" class="page">state (snapshot) of the delta table</a> at the version</p>
</li>
<li>
<p>Creates a new <a href="DeltaSourceSnapshot.html" class="page">DeltaSourceSnapshot</a> for the state (snapshot) as the current <a href="#initialState">DeltaSourceSnapshot</a></p>
</li>
<li>
<p>Changes the <a href="#initialStateVersion">initialStateVersion</a> internal registry to the requested version</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>getSnapshotAt</code> is used when <code>DeltaSource</code> is requested to <a href="#getChanges">getChanges</a> (with <code>isStartingVersion</code> flag enabled).
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="verifystreamhygieneandfilteraddfiles-internal-method"><a class="anchor" href="#verifystreamhygieneandfilteraddfiles-internal-method"></a><a class="link" href="#verifystreamhygieneandfilteraddfiles-internal-method"><a id="verifyStreamHygieneAndFilterAddFiles"></a> <code>verifyStreamHygieneAndFilterAddFiles</code> Internal Method</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">verifyStreamHygieneAndFilterAddFiles(
  actions: Seq[Action]): Seq[Action]</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>verifyStreamHygieneAndFilterAddFiles</code>&#8230;&#8203;FIXME</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>verifyStreamHygieneAndFilterAddFiles</code> is used when <code>DeltaSource</code> is requested to <a href="#getChanges">getChanges</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cleanupsnapshotresources-internal-method"><a class="anchor" href="#cleanupsnapshotresources-internal-method"></a><a class="link" href="#cleanupsnapshotresources-internal-method"><a id="cleanUpSnapshotResources"></a> <code>cleanUpSnapshotResources</code> Internal Method</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">cleanUpSnapshotResources(): Unit</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>cleanUpSnapshotResources</code>&#8230;&#8203;FIXME</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>cleanUpSnapshotResources</code> is used when <code>DeltaSource</code> is requested to <a href="#getSnapshotAt">getSnapshotAt</a>, <a href="#getBatch">getBatch</a> and <a href="#stop">stop</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="retrieving-last-element-from-iteratoriteratorlast-internal-method"><a class="anchor" href="#retrieving-last-element-from-iteratoriteratorlast-internal-method"></a><a class="link" href="#retrieving-last-element-from-iteratoriteratorlast-internal-method"><a id="iteratorLast"></a> Retrieving Last Element From Iterator&#8201;&#8212;&#8201;<code>iteratorLast</code> Internal Method</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">iteratorLast[T](
  iter: Iterator[T]): Option[T]</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>iteratorLast</code> simply returns the last element in the given <code>Iterator</code> or <code>None</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>iteratorLast</code> is used when <code>DeltaSource</code> is requested to <a href="#getStartingOffset">getStartingOffset</a> and <a href="#getOffset">getOffset</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="internal-properties"><a class="anchor" href="#internal-properties"></a><a class="link" href="#internal-properties"><a id="internal-properties"></a> Internal Properties</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>initialState</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="initialState"></a> <a href="DeltaSourceSnapshot.html" class="page">DeltaSourceSnapshot</a></p>
</div>
<div class="paragraph">
<p>Initially uninitialized (<code>null</code>).</p>
</div>
<div class="paragraph">
<p>Changes (along with the <a href="#initialStateVersion">initialStateVersion</a>) when <code>DeltaSource</code> is requested for the <a href="#getSnapshotAt">snapshot at a given version</a> (only when the versions are different)</p>
</div>
<div class="paragraph">
<p>Used when <code>DeltaSource</code> is requested for the <a href="#getSnapshotAt">snapshot at a given version</a></p>
</div>
<div class="paragraph">
<p>Closed and dereferenced (<code>null</code>) when <code>DeltaSource</code> is requested to <a href="#cleanUpSnapshotResources">cleanUpSnapshotResources</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>initialStateVersion</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="initialStateVersion"></a> Version of the <a href="#deltaLog">delta table</a></p>
</div>
<div class="paragraph">
<p>Initially <code>-1L</code> and changes (along with the <a href="#initialState">initialState</a>) to the version requested when <code>DeltaSource</code> is requested for the <a href="#getSnapshotAt">snapshot at a given version</a> (only when the versions are different)</p>
</div>
<div class="paragraph">
<p>Used when <code>DeltaSource</code> is requested to <a href="#cleanUpSnapshotResources">cleanUpSnapshotResources</a> (and unpersist the current snapshot)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>previousOffset</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="previousOffset"></a> Ending <a href="DeltaSourceOffset.html" class="page">DeltaSourceOffset</a> of the latest <a href="#getBatch">micro-batch</a></p>
</div>
<div class="paragraph">
<p>Starts uninitialized (<code>null</code>).</p>
</div>
<div class="paragraph">
<p>Used when <code>DeltaSource</code> is requested for the <a href="#getOffset">latest available offset</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tableId</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="tableId"></a> Table ID</p>
</div>
<div class="paragraph">
<p>Used when&#8230;&#8203;FIXME</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="DeltaOptions.html">DeltaOptions</a></span>
  <span class="next"><a href="DeltaSourceOffset.html">DeltaSourceOffset</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
